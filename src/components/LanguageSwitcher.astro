---
import { getLangFromUrl } from '../i18n/utils';
import SpainFlag from './icons/SpainFlag.astro';
import USFlag from './icons/USFlag.astro';

const lang = getLangFromUrl(Astro.url);
const path = Astro.url.pathname.replace(/^\/(en|es)/, '');
---

<div class="relative group">
  <button 
    class="flex items-center gap-2 hover:bg-white/20 p-2 transition-all duration-300"
    aria-label="Language selector"
    id="languageButton"
  >
    {lang === 'es' ? <SpainFlag /> : <USFlag />}
    <!-- <svg 
      class="w-4 h-4 text-white transition-transform duration-300 group-hover:rotate-180" 
      fill="none" 
      viewBox="0 0 24 24" 
      stroke="currentColor"
    >
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
    </svg> -->
  </button>

  <div 
    class="absolute right-0 mt-2 py-2 w-32 bg-white/10 backdrop-blur-md rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform origin-top scale-95 group-hover:scale-100"
    role="menu"
  >
    <a 
      href={`/es${path}`} 
      class={`flex items-center gap-2 px-4 py-2 text-sm text-white hover:bg-white/20 transition-colors ${lang === 'es' ? 'bg-white/10' : ''}`}
      role="menuitem"
    >
      <SpainFlag />
      <span>Espa√±ol</span>
    </a>
    <a 
      href={`/en${path}`} 
      class={`flex items-center gap-2 px-4 py-2 text-sm text-white hover:bg-white/20 transition-colors ${lang === 'en' ? 'bg-white/10' : ''}`}
      role="menuitem"
    >
      <USFlag />
      <span>English</span>
    </a>
  </div>
</div>